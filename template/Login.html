<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    <!-- Web App Settings -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="template/meta/favicon.svg" sizes="any">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="template/meta/apple-touch-icon.png">
    <link rel="apple-touch-icon-precomposed" href="template/meta/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="template/meta/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="template/meta/favicon-16x16.png">
    <link rel="mask-icon" href="template/meta/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00679e">
    <meta name="theme-color" content="#00679e">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Contrail One|Jockey One|Knewave|Lato|Lobster|Lora|Pacifico|Roboto|Viga&display=swap" rel="stylesheet">
    <!-- _____ -->
    <link rel="stylesheet" href="template/css/bootstrap-reboot.css">
    <link rel="stylesheet" href="template/css/bootstrap.min.css">
    <link rel="stylesheet" href="template/css/animate.css">
    <link rel="stylesheet" href="template/css/main.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script type="text/javascript" src="template/js/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="template/js/js.cookie.min.js"></script>
    <script type="text/javascript" src="template/js/moment.js"></script>
    <title>eGrade</title>
</head>
<body>
<div class="hasBg"></div>
<div class="grid-login">
    <div class="grid-login-sub">
    <form id="login-form" method="POST" action="index.php?function={{route}}">
        <h1 class="logo text-center mb-3">eGrade</h1>
        Schul-ID
        <input type="text" name="school" maxlength="5" value="{{prefill_school}}">
        Benutzername
        <input type="text" name="username">
        Passwort
        <input type="password" name="password" minlength="3">
        <button type="submit" class="btn btn-primary btn-lg egrade-login mt-3">Login</button>
        <!-- ATTRIBUTIO NEEDS TO BE INCLUDED !!!!!!!!!!!!!!!!!!!! 
        <div>Icons made by <a href="https://www.flaticon.com/authors/prettycons" title="prettycons">prettycons</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>
        https://www.iconfinder.com/iconsets/free-98-icons  
        -->
    </form>
    <!-- <button class="btnAdd">Add to Homescreen</button> -->
</div>
</div>
</body>
<script>
    if ('serviceWorker' in navigator) {
       console.log("Will the service worker register?");
       navigator.serviceWorker.register('service-worker.js')
         .then(function(reg){
           console.log("Yes, it did.");
        }).catch(function(err) {
           console.log("No it didn't. This happened:", err)
       });
    }

    let deferredPrompt;
    let btnAdd = document.querySelector(".btnAdd"); // .btnAdd maybe id or class

window.addEventListener('beforeinstallprompt', function(event) {
  // Prevent Chrome 67 and earlier from automatically showing the prompt
  e.preventDefault();
  // Stash the event so it can be triggered later.
  deferredPrompt = e;
});

// Installation must be done by a user gesture! Here, the button click
btnAdd.addEventListener('click', (e) => {
  // hide our user interface that shows our A2HS button
  btnAdd.style.display = 'none';
  // Show the prompt
  deferredPrompt.prompt();
  // Wait for the user to respond to the prompt
  deferredPrompt.userChoice
    .then((choiceResult) => {
      if (choiceResult.outcome === 'accepted') {
        console.log('User accepted the A2HS prompt');
      } else {
        console.log('User dismissed the A2HS prompt');
      }
      deferredPrompt = null;
    });
});

</script>
</html>